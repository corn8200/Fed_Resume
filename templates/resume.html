<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>{{ r.contact.name }} — Federal Résumé</title>
    <style>
      @page { size: Letter; margin: 0.5in; }
      :root { --muted: #555; }
      html, body { height: 100%; }
      body {
        font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
        font-size: 10pt; line-height: 1.25; color: #000;
        margin: 0;
      }
      .page { padding: 0.5in; }
      h1 { font-size: 14pt; margin: 0 0 4px 0; }
      h2 { font-size: 12pt; margin: 10px 0 6px 0; padding-bottom: 3px; border-bottom: 1px solid #ddd; }
      h3 { font-size: 10.5pt; margin: 0 0 2px 0; }
      .muted { color: var(--muted); }
      .row { display: flex; gap: 12px; align-items: baseline; flex-wrap: wrap; }
      .header { display: flex; justify-content: space-between; gap: 16px; flex-wrap: wrap; }
      .header-left { flex: 1 1 auto; }
      .header-right { flex: 0 0 auto; text-align: right; }
      .links a, .links-row a { color: inherit; text-decoration: none; overflow-wrap: anywhere; word-break: break-word; hyphens: auto; }
      .links a:hover { text-decoration: underline; }
      .section { margin-top: 8px; }
      .entry { margin: 6px 0; }
      .avoid-break { /* legacy; avoid using on large blocks */ }
      .job-head { break-inside: avoid; page-break-inside: avoid; }
      .entry-body { margin-top: 2px; }
      .meta, .supervisor { margin: 2px 0; }
      ul { margin: 4px 0 0 18px; padding: 0; }
      li { margin: 2px 0; }
      .chips { display: flex; gap: 6px; flex-wrap: wrap; }
      .chip { border: 1px solid #ccc; padding: 1px 6px; border-radius: 10px; font-size: 10pt; }
      .print-btn { position: sticky; top: 0; background: #fff; border: 1px solid #ccc; padding: 6px 10px; border-radius: 4px; cursor: pointer; }
      .topbar { position: sticky; top: 0; display: flex; justify-content: end; padding: 6px 0; background: rgba(255,255,255,0.9); }
      .kv { display: inline-flex; gap: 8px; flex-wrap: wrap; font-size: 10pt; }
      .kv b { font-weight: 600 !important; color: var(--muted) !important; }
      .links-row { display: flex; gap: 8px; align-items: baseline; flex-wrap: wrap; font-size: 10pt; }
      /* Match link label styling to KV labels exactly */
      .links-row strong { font-weight: 600 !important; color: var(--muted) !important; }
      .contact-line { display: inline-flex; gap: 8px; align-items: baseline; flex-wrap: wrap; }
      .contact-pair { display: inline-flex; gap: 8px; white-space: nowrap; }
      .contact-line .sep { color: var(--muted); }
      .links-row .sep { color: var(--muted); }
      /* Improve general wrapping */
      body { overflow-wrap: anywhere; hyphens: auto; }
      .tail { display: block; }
      /* Optional on-screen two-column preview to match print */
      @media screen and (min-width: 960px) {
        .tail--screen-2col {
          -webkit-column-count: 2;
          column-count: 2;
          -webkit-column-gap: 18pt;
          column-gap: 18pt;
          -webkit-column-fill: auto;
          column-fill: auto;
        }
        .tail--screen-2col .section { break-inside: avoid; -webkit-column-break-inside: avoid; }
        .tail--screen-2col .no-split { break-inside: avoid; -webkit-column-break-inside: avoid; }
        .tail--screen-2col .entry { break-inside: avoid; -webkit-column-break-inside: avoid; }
      }
      @media print {
        /* Ensure the document can paginate beyond one page */
        html, body { height: auto !important; }
        .page { height: auto !important; overflow: visible !important; }
        .no-print { display: none !important; }
        .topbar { display: none !important; }
        .page { padding: 0; }
        /* Page + typography */
        @page { size: Letter; margin: 0.5in; }
        body { font-size: 10pt; line-height: 1.25; }
        /* Force Education to a new page in print */
        .section.education { break-before: page; page-break-before: always; }
        /* Compact mode: reclaim ~4–8 lines without content loss */
        .compact { font-size: 10pt; line-height: 1.2; }
        .compact h1 { margin: 0 0 4pt; }
        .compact h2 { margin: 0 0 3pt; border-bottom: none; }
        .compact h3 { margin: 0 0 3pt; }
        .compact p { margin: 0 0 3pt; }
        .compact .section { padding: 0 0 3pt 0; }
        .compact .entry { margin: 2pt 0; }
        .compact ul, .compact ol { padding-left: 0.9em; margin: 0 0 2pt; }
        .compact li { margin: 0; }
        .compact .kv, .compact .links-row, .compact .contact-line { gap: 6px; }
        /* Display adjustments to let natural breaks happen */
        .header, .section, .entry { display: block; }
        /* Tighter spacing for print */
        .section { margin-top: 0; padding: 0 0 6pt 0; }
        .entry { margin: 4pt 0; }
        h1 { margin: 0 0 5pt; }
        h2 { margin: 0 0 5pt; }
        h3 { margin: 0 0 4pt; }
        p { margin: 0 0 4pt; }
        ul, ol { padding-left: 1.05em; margin: 0 0 3pt; }
        li { margin: 0 0 1.5pt; }
        /* Keep headings with following content */
        h2, h3 { break-after: avoid; page-break-after: avoid; }
        /* Widow/orphan control where supported */
        p, li { widows: 2; orphans: 2; }
        .section, .entry, .entry-body { break-inside: auto; page-break-inside: auto; }
        .job-head { break-inside: avoid; page-break-inside: avoid; break-after: avoid; }
        /* Let flex blocks wrap naturally in print */
        .header { align-items: flex-start; }
        /* Two-column tail with sane breaking in print */
        .tail {
          -webkit-column-count: 1;
          column-count: 1;
        }
        .compact .tail { }
        /* Do NOT split sections across columns/pages */
        .tail .section { break-inside: avoid !important; page-break-inside: avoid !important; -webkit-column-break-inside: avoid !important; }
        /* Keep small entries together for readability */
        .tail .entry { break-inside: avoid !important; page-break-inside: avoid !important; -webkit-column-break-inside: avoid !important; }
        /* Prevent end-of-page column splitting for short sections */
        .tail .no-split { break-inside: avoid !important; page-break-inside: avoid !important; -webkit-column-break-inside: avoid !important; }
        /* Smaller link text in print */
        .links, .header-right, .links a, .links-row { font-size: 10pt !important; }
        .compact .kv, .compact .links-row, .compact .meta { font-size: 10pt !important; }
        .links-row { margin-top: 2pt; }
        /* Optional trimming for very long bullet lists when marked */
        .bullets--long li:nth-child(n+7) { display: none; }
        /* Optional future-dated volunteer hiding when marked (gated by body.hide-future) */
        .hide-future .volunteer .future { display: none; }
      }
    </style>
  </head>
  <body class="{% if compact %}compact {% endif %}{% if hide_future %}hide-future{% endif %}">
    <div class="topbar no-print">
      <button class="print-btn" onclick="window.print()">Print / Save as PDF</button>
    </div>
    <div class="page">
      <header class="header">
        <div class="header-left">
          <h1>{{ r.contact.name }}</h1>
          <div class="contact-line muted" style="font-size: 10pt;">
            <div class="contact-pair"><span>{{ r.contact.email }}</span><span class="sep">•</span><span>{{ r.contact.phone }}</span></div>
            {% if r.contact.location %}
              <span class="sep">•</span>
              <span>{{ r.contact.location }}</span>
            {% endif %}
          </div>
          {% if r.citizenship or r.veterans_preference or r.eligibilities %}
          <div class="kv muted">
            {% if r.citizenship %}<div><b>Citizenship:</b> {{ r.citizenship }}</div>{% endif %}
            {% if r.veterans_preference %}<div><b>Veterans’ Preference:</b> {{ r.veterans_preference }}</div>{% endif %}
            {% if r.eligibilities %}<div><b>Hiring Eligibility:</b> {{ r.eligibilities | join(', ') }}</div>{% endif %}
          </div>
          {% endif %}
        {% if r.contact.links %}
          <div class="links-row">
            {% for label, url in r.contact.links.items() %}
              <span class="link-item"><strong>{{ label }}:</strong> <a href="{{ url }}">{{ url }}</a></span>{% if not loop.last %}<span class="sep">•</span>{% endif %}
            {% endfor %}
          </div>
        {% endif %}
        </div>
      </header>

      {% if r.summary %}
      <section class="section">
        <h2>Summary</h2>
        <p class="entry" style="margin: 4px 0 0 0;">{{ r.summary }}</p>
      </section>
      {% endif %}

      {% if r.work %}
      <section class="section">
        <h2>Work Experience</h2>
        {% for w in r.work %}
        <div class="entry">
          <div class="job-head">
            <h3>
              {{ w.title }}
              {% if w.series_grade %}
                <span class="muted">({{ w.series_grade }})</span>
              {% endif %}
            </h3>
            <div class="muted">{{ w.employer }}{% if w.location %}, {{ w.location }}{% endif %}</div>
            {% if w.address %}
              <div class="muted">{{ w.address }}</div>
            {% endif %}
            <div class="meta muted">
              {{ w.start|fmtdate }} – {{ 'Present' if w.present else (w.end|fmtdate) }}
              • {{ w.hours_per_week }} hrs/week
              {% if w.salary %} • {{ w.salary }}{% endif %}
            </div>
            {% if w.supervisor or (w.can_contact_supervisor is not none) %}
            <div class="supervisor muted">
              Supervisor: {{ w.supervisor if w.supervisor else '—' }}
              {% if w.can_contact_supervisor is not none %}
                — OK to contact: {{ 'Yes' if w.can_contact_supervisor else 'No' }}
              {% endif %}
            </div>
            {% endif %}
          </div>
          <div class="entry-body">
            {% if w.duties %}
              <div class="muted">Duties: {{ w.duties }}</div>
            {% endif %}
            {% if w.highlights %}
            <ul class="bullets--long">
              {% for h in w.highlights %}
                <li>{{ h }}</li>
              {% endfor %}
            </ul>
            {% endif %}
          </div>
        </div>
        {% endfor %}
      </section>
      {% endif %}

      {% if r.education %}
      <section class="section education">
        <h2>Education</h2>
        {% for e in r.education %}
        <div class="entry">
          <div><strong>{{ e.institution }}</strong>{% if e.location %}, <span class="muted">{{ e.location }}</span>{% endif %}</div>
          <div>
            {{ e.degree }}{% if e.field %}, {{ e.field }}{% endif %}
            {% if e.gpa %} — GPA: {{ e.gpa }}{% endif %}
          </div>
          {% if e.completion_date %}
            <div class="muted">{{ e.completion_date }}</div>
          {% endif %}
        </div>
        {% endfor %}
      </section>
      {% endif %}

      {% if r.certifications %}
      <section class="section">
        <h2>Certifications / Licensures</h2>
        <ul>
          {% for c in r.certifications %}
            <li>{{ c }}</li>
          {% endfor %}
        </ul>
      </section>
      {% endif %}

      {% if r.training %}
      <section class="section">
        <h2>Training</h2>
        <ul>
          {% for t in r.training %}
            <li>{{ t }}</li>
          {% endfor %}
        </ul>
      </section>
      {% endif %}

      {% if r.languages %}
      <section class="section">
        <h2>Languages</h2>
        <div class="chips">
          {% for lang in r.languages %}
            <span class="chip">{{ lang }}</span>
          {% endfor %}
        </div>
      </section>
      {% endif %}

      {% if r.clearances %}
      <section class="section">
        <h2>Clearances</h2>
        <ul>
          {% for cl in r.clearances %}
            <li>{{ cl }}</li>
          {% endfor %}
        </ul>
      </section>
      {% endif %}

      <div class="tail {% if columns == 2 %}tail--screen-2col{% endif %}">
        {% if r.volunteer %}
        <section class="section volunteer">
          <h2>Volunteer Experience</h2>
          {% for v in r.volunteer %}
          <div class="entry{% if v.start and '2025' in v.start %} future{% endif %}">
            <div><strong>{{ v.organization }}</strong>{% if v.location %}, <span class="muted">{{ v.location }}</span>{% endif %}</div>
            <div class="muted">{{ v.role }}</div>
            <div class="meta muted">{{ v.start|fmtdate }} – {{ 'Present' if v.present else (v.end|fmtdate) }}</div>
            {% if v.highlights %}
            <ul>
              {% for h in v.highlights %}<li>{{ h }}</li>{% endfor %}
            </ul>
            {% endif %}
          </div>
          {% endfor %}
        </section>
        {% endif %}

        {% if r.awards %}
        <section class="section no-split">
          <h2>Awards</h2>
          <ul>
            {% for a in r.awards %}<li>{{ a }}</li>{% endfor %}
          </ul>
        </section>
        {% endif %}

        {% if r.publications %}
        <section class="section no-split">
          <h2>Publications</h2>
          <ul>
            {% for p in r.publications %}<li>{{ p }}</li>{% endfor %}
          </ul>
        </section>
        {% endif %}

        {% if r.affiliations %}
        <section class="section no-split">
          <h2>Professional Affiliations</h2>
          <ul>
            {% for af in r.affiliations %}<li>{{ af }}</li>{% endfor %}
          </ul>
        </section>
        {% endif %}

        {% if r.references %}
        <section class="section no-split">
          <h2>References</h2>
          {% for ref in r.references %}
          <div class="entry">
            {{ ref.name }} — {{ ref.phone }}{% if ref.email %} — {{ ref.email }}{% endif %}
          </div>
          {% endfor %}
        </section>
        {% endif %}
      </div>
    </div>
  </body>
  </html>
